%% SDK Generation Pipeline - Auto-generated by scripts/generate-pipeline-diagram.js
%% Run: pnpm openapi:diagram
%% Last generated: 2026-01-11T18:26:03.612Z
%% Sources parsed from: sync-specs.js, orval.config.ts, package.json

flowchart TB
    subgraph REMOTE["REMOTE SOURCES"]
        direction TB
        REMOTE_GLADIA["gladia<br/>api.gladia.io/openapi.json..."]
        REMOTE_ASSEMBLYAI["assemblyai<br/>raw.githubusercontent.com/AssemblyAI/ass..."]
        REMOTE_ASSEMBLYAIASYNC["assemblyaiAsync<br/>raw.githubusercontent.com/AssemblyAI/ass..."]
        REMOTE_ASSEMBLYAISTREAMING["assemblyaiStreaming<br/>raw.githubusercontent.com/AssemblyAI/ass..."]
        REMOTE_DEEPGRAM["deepgram<br/>raw.githubusercontent.com/deepgram/deepg..."]
        REMOTE_OPENAI["openai<br/>app.stainless.com/api/spec/documented/op..."]
        REMOTE_AZURE["azure<br/>raw.githubusercontent.com/Azure/azure-re..."]
        REMOTE_SPEECHMATICS["speechmatics<br/>raw.githubusercontent.com/speechmatics/s..."]
        REMOTE_SPEECHMATICSASYNC["speechmaticsAsync<br/>raw.githubusercontent.com/speechmatics/s..."]
        REMOTE_DEEPGRAMSTREAMING["deepgramStreaming<br/>raw.githubusercontent.com/deepgram/deepg..."]
        REMOTE_SONIOX["soniox<br/>api.soniox.com/v1/openapi.json..."]
    end

    subgraph SYNC["SPEC SYNC"]
        SYNC_SCRIPT["sync-specs.js<br/>pnpm openapi:sync"]
    end

    subgraph MANUAL["MANUAL SPECS"]
        direction TB
        MANUAL_SPEECHMATICSBATCHTYPES["speechmatics-batch-types.zod.ts<br/>Curated batch schemas for field-configs"]
        MANUAL_SONIOXSTREAMING["soniox-streaming-types.ts<br/>No official AsyncAPI spec - types extracted from @soniox/speech-to-text-web SDK"]
    end

    subgraph MANUAL_TYPES["MANUAL TYPE OVERRIDES"]
        direction TB
        MT_DEEPGRAM["deepgram/<br/>3 type files"]
    end

    subgraph SPECS["specs/ directory"]
        direction TB
        SPEC_ASSEMBLYAI_ASYNCAPI["assemblyai-asyncapi.json"]
        SPEC_ASSEMBLYAI_OPENAPI["assemblyai-openapi.json"]
        SPEC_ASSEMBLYAI_STREAMING_SDK["assemblyai-streaming-sdk.ts"]
        SPEC_ASSEMBLYAI_STREAMING_TYPES["assemblyai-streaming-types.ts"]
        SPEC_AZURE_STT_OPENAPI["azure-stt-openapi.json"]
        SPEC_DEEPGRAM_OPENAPI["deepgram-openapi.yml"]
        SPEC_DEEPGRAM_STREAMING_SDK["deepgram-streaming-sdk.ts"]
        SPEC_GLADIA_OPENAPI["gladia-openapi.json"]
        SPEC_OPENAI_OPENAPI["openai-openapi.yaml"]
        SPEC_OPENAI_REALTIME_TYPES["openai-realtime-types.ts"]
        SPEC_SONIOX_OPENAPI["soniox-openapi.json"]
        SPEC_SONIOX_STREAMING_TYPES["soniox-streaming-types.ts"]
        SPEC_SPEECHMATICS_ASYNCAPI["speechmatics-asyncapi.yml"]
        SPEC_SPEECHMATICS_BATCH_TYPES_ZOD["speechmatics-batch-types.zod.ts"]
        SPEC_SPEECHMATICS_BATCH["speechmatics-batch.yml"]
    end

    subgraph FIX_PRE["PRE-ORVAL FIXES"]
        direction TB
        PRE_FIX_DEEPGRAM_SPEC["fix-deepgram-spec.js<br/>fixes deepgram spec"]
        PRE_FIX_OPENAI_SPEC["fix-openai-spec.js<br/>fixes openai spec"]
        PRE_FIX_SPEECHMATICS_SPEC["fix-speechmatics-spec.js<br/>fixes speechmatics spec"]
    end

    subgraph ORVAL["ORVAL GENERATION"]
        direction TB
        ORVAL_CFG["orval.config.ts<br/>14 projects"]
        ORVAL_API["API clients<br/>axios-functions"]
        ORVAL_ZOD["Zod schemas<br/>runtime validation"]
        ORVAL_TYPES["TypeScript types<br/>schema/ directories"]
    end

    subgraph FIX_POST["POST-ORVAL FIXES"]
        direction TB
        POST_FIX_ASSEMBLYAI_MISSING_SCHEMAS["fix-assemblyai-missing-schemas.js"]
        POST_FIX_GENERATED["fix-generated.js"]
        POST_SED["sed fixes<br/>speechmatics string literals"]
    end

    subgraph STREAMING["STREAMING TYPE GENERATION"]
        direction TB
        STREAM_SYNC_ASSEMBLYAI_STREAMING_TYPES["sync-assemblyai-streaming-types.js<br/>assemblyai"]
        STREAM_SYNC_DEEPGRAM_STREAMING_TYPES["sync-deepgram-streaming-types.js<br/>deepgram"]
        STREAM_SYNC_SONIOX_STREAMING_TYPES["sync-soniox-streaming-types.js<br/>soniox"]
        STREAM_SYNC_SPEECHMATICS_STREAMING_TYPES["sync-speechmatics-streaming-types.js<br/>speechmatics"]
    end

    subgraph LANGS["LANGUAGE EXTRACTION"]
        direction TB
        LANG_GENERATE_SONIOX_LANGUAGES["generate-soniox-languages.js"]
    end

    subgraph GENERATED["src/generated/"]
        direction TB
        GEN_ASSEMBLYAI["assemblyai/<br/>api/ schema/ streaming"]
        GEN_AZURE["azure/<br/>api/ schema/"]
        GEN_DEEPGRAM["deepgram/<br/>api/ schema/ streaming"]
        GEN_GLADIA["gladia/<br/>api/ schema/"]
        GEN_OPENAI["openai/<br/>api/ schema/ streaming"]
        GEN_SONIOX["soniox/<br/>api/ schema/ streaming languages"]
        GEN_SPEECHMATICS["speechmatics/<br/>api/ schema/ streaming batch"]
    end

    subgraph EXPORTS["SDK EXPORTS"]
        direction TB
        EXP_FIELD["field-configs.ts<br/>zodToFieldConfigs()"]
        EXP_INDEX["index.ts<br/>Types + Zod namespaces"]
        EXP_META["provider-metadata.ts<br/>Provider info"]
        EXP_CONST["constants.ts<br/>Enums + constants"]
    end

    subgraph SDK_INTERNALS["SDK INTERNALS"]
        direction TB
        subgraph ADAPTERS["Provider Adapters"]
            direction LR
            ADAPT_ASSEMBLYAI["assemblyai"]
            ADAPT_AZURE_STT["azure-stt"]
            ADAPT_BASE["base"]
            ADAPT_DEEPGRAM["deepgram"]
            ADAPT_GLADIA["gladia"]
            ADAPT_OPENAI_WHISPER["openai-whisper"]
            ADAPT_SONIOX["soniox"]
            ADAPT_SPEECHMATICS["speechmatics"]
        end
        subgraph WEBHOOKS["Webhook Handlers"]
            direction LR
            HOOK_ASSEMBLYAI["assemblyai"]
            HOOK_AZURE["azure"]
            HOOK_BASE["base"]
            HOOK_DEEPGRAM["deepgram"]
            HOOK_GLADIA["gladia"]
            HOOK_SPEECHMATICS["speechmatics"]
        end
        subgraph ROUTER["Voice Router"]
            direction TB
            ROUTER_MAIN["voice-router.ts<br/>VoiceRouter class"]
            ROUTER_TYPES["types.ts<br/>TranscriptionConfig"]
            ROUTER_STREAM["provider-streaming-types.ts"]
        end
    end

    subgraph PUBLIC_API["PUBLIC API (what users import)"]
        direction TB
        API_ROUTER["VoiceRouter<br/>Multi-provider routing"]
        API_ADAPTERS["Provider Adapters<br/>Direct provider access"]
        API_WEBHOOKS["WebhookRouter<br/>Webhook handling"]
        API_TYPES["Types + Zod Schemas<br/>Runtime validation"]
        API_CONFIGS["Field Configs<br/>UI form generation"]
        API_META["Provider Metadata<br/>Provider capabilities"]
    end

    %% Remote sources to sync script
    REMOTE --> SYNC_SCRIPT

    %% Sync script to specs
    SYNC_SCRIPT --> SPECS

    %% Manual specs to specs directory
    MANUAL --> SPECS

    %% Manual type overrides
    MANUAL_TYPES --> FIX_POST

    %% Specs requiring pre-processing
    SPEC_DEEPGRAM_OPENAPI --> PRE_FIX_DEEPGRAM_SPEC
    SPEC_OPENAI_WHISPER_OPENAPI --> PRE_FIX_OPENAI_SPEC
    SPEC_SPEECHMATICS_BATCH --> PRE_FIX_SPEECHMATICS_SPEC

    %% Pre-fixes to Orval
    PRE_FIX_DEEPGRAM_SPEC --> ORVAL
    PRE_FIX_OPENAI_SPEC --> ORVAL
    PRE_FIX_SPEECHMATICS_SPEC --> ORVAL

    %% Specs directly to Orval (no pre-processing needed)
    SPECS --> ORVAL

    %% Orval internal flow
    ORVAL_CFG --> ORVAL_API
    ORVAL_CFG --> ORVAL_ZOD
    ORVAL_CFG --> ORVAL_TYPES

    %% Orval to post-fixes
    ORVAL --> FIX_POST

    %% Post-fixes to generated
    FIX_POST --> GENERATED

    %% Streaming spec sources to streaming scripts
    SPEC_ASSEMBLYAI_ASYNCAPI --> STREAM_SYNC_ASSEMBLYAI_STREAMING_TYPES
    SPEC_DEEPGRAM_STREAMING_SDK --> STREAM_SYNC_DEEPGRAM_STREAMING_TYPES
    SPEC_SONIOX_STREAMING_TYPES --> STREAM_SYNC_SONIOX_STREAMING_TYPES
    SPEC_SPEECHMATICS_ASYNCAPI --> STREAM_SYNC_SPEECHMATICS_STREAMING_TYPES

    %% Streaming scripts to generated
    STREAMING --> GENERATED

    %% Language extraction to generated
    LANGS --> GENERATED

    %% Generated to exports
    GENERATED --> EXP_FIELD
    GENERATED --> EXP_INDEX
    GENERATED --> EXP_META
    EXP_FIELD --> EXP_INDEX

    %% Exports and generated consumed by SDK internals
    EXPORTS --> SDK_INTERNALS
    GENERATED --> SDK_INTERNALS

    %% SDK internals to public API
    ADAPTERS --> API_ADAPTERS
    WEBHOOKS --> API_WEBHOOKS
    ROUTER --> API_ROUTER
    EXP_FIELD --> API_CONFIGS
    EXP_META --> API_META
    EXP_INDEX --> API_TYPES

    %% Styling
    classDef remote fill:#e3f2fd,stroke:#1565c0
    classDef manual fill:#fce4ec,stroke:#c2185b
    classDef fix fill:#fff3e0,stroke:#ef6c00
    classDef gen fill:#e8f5e9,stroke:#2e7d32
    classDef export fill:#f3e5f5,stroke:#7b1fa2
    classDef internal fill:#e0f2f1,stroke:#00695c
    classDef api fill:#fff9c4,stroke:#f9a825

    class REMOTE,SYNC remote
    class MANUAL,MANUAL_TYPES manual
    class FIX_PRE,FIX_POST fix
    class ORVAL,GENERATED,STREAMING,LANGS gen
    class EXPORTS export
    class SDK_INTERNALS,ADAPTERS,WEBHOOKS,ROUTER internal
    class PUBLIC_API api
