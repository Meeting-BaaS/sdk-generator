#!/usr/bin/env node
/**
 * Creates missing AssemblyAI schema files that Orval doesn't generate
 * These are simple scalar types that Orval skips
 */

const fs = require("fs")
const path = require("path")

const SCHEMA_DIR = path.join(__dirname, "..", "src", "generated", "assemblyai", "schema")

const HEADER = `/**
 * Generated by orval v7.9.0 ðŸº
 * Do not edit manually.
 * AssemblyAI API
 * AssemblyAI API
 * OpenAPI spec version: 1.3.4
 */

`

const schemas = [
  {
    filename: "afterId.ts",
    content: `${HEADER}/**
 * Get transcripts that were created after this transcript ID
 */
export type AfterId = string
`
  },
  {
    filename: "beforeId.ts",
    content: `${HEADER}/**
 * Get transcripts that were created before this transcript ID
 */
export type BeforeId = string
`
  },
  {
    filename: "createdOn.ts",
    content: `${HEADER}/**
 * Only get transcripts created on this date
 */
export type CreatedOn = string
`
  },
  {
    filename: "limit.ts",
    content: `${HEADER}/**
 * Maximum amount of transcripts to retrieve
 */
export type Limit = number
`
  },
  {
    filename: "throttledOnly.ts",
    content: `${HEADER}/**
 * Only get throttled transcripts, overrides the status filter
 */
export type ThrottledOnly = boolean
`
  }
]

console.log("ðŸ”§ Creating missing AssemblyAI schema files...")

let created = 0

for (const schema of schemas) {
  const filePath = path.join(SCHEMA_DIR, schema.filename)

  if (!fs.existsSync(filePath)) {
    fs.writeFileSync(filePath, schema.content, "utf-8")
    console.log(`  âœ… Created ${schema.filename}`)
    created++
  }
}

if (created > 0) {
  console.log(`\nâœ… Created ${created} missing schema files`)
} else {
  console.log("\nâœ¨ All schema files already exist")
}
